1.
--

1.  OpenWeatherMap, a global geospatial platform provides earth observation data including current, historical and forcasting weather data, map layer data as well as air pollution data. The data I want to use in this assignment is the historical UV index data.
2.  OpenWeatherMap <https://openweathermap.org/api>
    OpenWeatherMap-UV <https://openweathermap.org/api/uvi>
3.  base URL endpoint: <http://api.openweathermap.org/data/2.5/uvi/history?> `http://api.openweathermap.org/data/2.5/uvi/history?appid={appid}&lat={lat}&lon={lon}&cnt={cnt}&start={start}&end={end}`

2.
--

1.  There are five levels of API, Free, Startup, Developer, Professional and Enterprise. The calls per minute and access to some databases are limited for free account. To get a free account, just sign up.
2.  Apply for an API key by signing up for a free account <https://home.openweathermap.org/users/sign_up>

3.
--

1.  

``` r
library(httr)
```

    ## Warning: package 'httr' was built under R version 3.4.2

``` r
endpoint= "http://api.openweathermap.org/data/2.5/uvi/history?"
key=Sys.getenv("OWM_APP_TOKEN")
lat="40.0"
lon="-74.0"
start="1498049953"
end="1508644800"
url=paste(endpoint,"lat=", lat, "&lon=", lon, "&start=", start, "&end=", end, "&appid=", key, sep="")
query=GET(url)
```

the parameter: lat means latitude, lon means longitude, start and end mean the starting and final point of time period in UNIX time. This query requests the UV index data from 2017/6/22 to 2017/10/22 in New York (40, -74).

1.  

``` r
http_status(query)
```

    ## $category
    ## [1] "Success"
    ## 
    ## $reason
    ## [1] "OK"
    ## 
    ## $message
    ## [1] "Success: (200) OK"

1.  

``` r
http_type(query)
```

    ## [1] "application/json"

4.
--

1.  

``` r
library(jsonlite)
```

    ## Warning: package 'jsonlite' was built under R version 3.4.2

``` r
data=fromJSON(url, simplifyDataFrame = TRUE)
```

1.  

``` r
head(data)
```

    ##   lat lon             date_iso       date value
    ## 1  40 -74 2017-06-22T12:00:00Z 1498132800  9.91
    ## 2  40 -74 2017-06-23T12:00:00Z 1498219200 10.64
    ## 3  40 -74 2017-06-24T12:00:00Z 1498305600  9.69
    ## 4  40 -74 2017-06-25T12:00:00Z 1498392000 10.12
    ## 5  40 -74 2017-06-26T12:00:00Z 1498478400  8.79
    ## 6  40 -74 2017-06-27T12:00:00Z 1498564800  8.47

``` r
dim(data)
```

    ## [1] 107   5

``` r
summary(data$value)
```

    ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    ##   3.320   5.965   7.750   7.291   8.805  10.640

``` r
saveRDS(data, "data.rds")
```

5.
--

``` r
GetSearchResults <- function(lat="40", lon="-74", start="1498049953", end="1508644800"){
  library(httr)
  endpoint= "http://api.openweathermap.org/data/2.5/uvi/history?"
  key=Sys.getenv("OWM_APP_TOKEN")
  url=paste(endpoint,"lat=", lat, "&lon=", lon, "&start=", start, "&end=", end, "&appid=", key, sep="")
  query=GET(url)
  if (http_status(query)$reason!="OK") print(http_status(query)$message)
  else {
    data=fromJSON(url, simplifyDataFrame = TRUE)
    return(data)
  }
}
rds=GetSearchResults()
rds
```

    ##     lat lon             date_iso       date value
    ## 1    40 -74 2017-06-22T12:00:00Z 1498132800  9.91
    ## 2    40 -74 2017-06-23T12:00:00Z 1498219200 10.64
    ## 3    40 -74 2017-06-24T12:00:00Z 1498305600  9.69
    ## 4    40 -74 2017-06-25T12:00:00Z 1498392000 10.12
    ## 5    40 -74 2017-06-26T12:00:00Z 1498478400  8.79
    ## 6    40 -74 2017-06-27T12:00:00Z 1498564800  8.47
    ## 7    40 -74 2017-06-28T12:00:00Z 1498651200  7.22
    ## 8    40 -74 2017-06-29T12:00:00Z 1498737600  9.06
    ## 9    40 -74 2017-06-30T12:00:00Z 1498824000  9.56
    ## 10   40 -74 2017-07-01T12:00:00Z 1498910400 10.45
    ## 11   40 -74 2017-07-02T12:00:00Z 1498996800  9.00
    ## 12   40 -74 2017-07-03T12:00:00Z 1499083200  8.97
    ## 13   40 -74 2017-07-04T12:00:00Z 1499169600  8.77
    ## 14   40 -74 2017-07-05T12:00:00Z 1499256000  9.58
    ## 15   40 -74 2017-07-06T12:00:00Z 1499342400  9.03
    ## 16   40 -74 2017-07-07T12:00:00Z 1499428800  8.92
    ## 17   40 -74 2017-07-08T12:00:00Z 1499515200  8.97
    ## 18   40 -74 2017-07-09T12:00:00Z 1499601600  8.42
    ## 19   40 -74 2017-07-10T12:00:00Z 1499688000  9.03
    ## 20   40 -74 2017-07-11T12:00:00Z 1499774400  9.47
    ## 21   40 -74 2017-07-12T12:00:00Z 1499860800  9.91
    ## 22   40 -74 2017-07-13T12:00:00Z 1499947200  9.82
    ## 23   40 -74 2017-07-14T12:00:00Z 1500033600  9.44
    ## 24   40 -74 2017-07-15T12:00:00Z 1500120000  9.20
    ## 25   40 -74 2017-07-16T12:00:00Z 1500206400  9.17
    ## 26   40 -74 2017-07-17T12:00:00Z 1500292800  8.99
    ## 27   40 -74 2017-07-18T12:00:00Z 1500379200  8.26
    ## 28   40 -74 2017-07-19T12:00:00Z 1500465600  9.75
    ## 29   40 -74 2017-07-20T12:00:00Z 1500552000  9.74
    ## 30   40 -74 2017-07-21T12:00:00Z 1500638400  9.61
    ## 31   40 -74 2017-07-22T12:00:00Z 1500724800  9.40
    ## 32   40 -74 2017-07-23T12:00:00Z 1500811200  9.02
    ## 33   40 -74 2017-08-01T12:00:00Z 1501588800  8.48
    ## 34   40 -74 2017-08-02T12:00:00Z 1501675200  8.79
    ## 35   40 -74 2017-08-03T12:00:00Z 1501761600  8.63
    ## 36   40 -74 2017-08-04T12:00:00Z 1501848000  8.08
    ## 37   40 -74 2017-08-05T12:00:00Z 1501934400  8.17
    ## 38   40 -74 2017-08-06T12:00:00Z 1502020800  8.28
    ## 39   40 -74 2017-08-07T12:00:00Z 1502107200  8.70
    ## 40   40 -74 2017-08-08T12:00:00Z 1502193600  8.24
    ## 41   40 -74 2017-08-09T12:00:00Z 1502280000  7.75
    ## 42   40 -74 2017-08-10T12:00:00Z 1502366400  8.12
    ## 43   40 -74 2017-08-11T12:00:00Z 1502452800  8.26
    ## 44   40 -74 2017-08-12T12:00:00Z 1502539200  8.69
    ## 45   40 -74 2017-08-13T12:00:00Z 1502625600  8.00
    ## 46   40 -74 2017-08-14T12:00:00Z 1502712000  8.69
    ## 47   40 -74 2017-08-15T12:00:00Z 1502798400  8.82
    ## 48   40 -74 2017-08-16T12:00:00Z 1502884800  7.62
    ## 49   40 -74 2017-08-17T12:00:00Z 1502971200  8.45
    ## 50   40 -74 2017-08-18T12:00:00Z 1503057600  8.32
    ## 51   40 -74 2017-08-19T12:00:00Z 1503144000  8.02
    ## 52   40 -74 2017-08-20T12:00:00Z 1503230400  7.92
    ## 53   40 -74 2017-08-21T12:00:00Z 1503316800  8.00
    ## 54   40 -74 2017-08-22T12:00:00Z 1503403200  8.37
    ## 55   40 -74 2017-08-23T12:00:00Z 1503489600  8.00
    ## 56   40 -74 2017-08-24T12:00:00Z 1503576000  8.02
    ## 57   40 -74 2017-08-25T12:00:00Z 1503662400  7.10
    ## 58   40 -74 2017-08-26T12:00:00Z 1503748800  6.87
    ## 59   40 -74 2017-08-27T12:00:00Z 1503835200  7.15
    ## 60   40 -74 2017-08-28T12:00:00Z 1503921600  7.18
    ## 61   40 -74 2017-08-29T12:00:00Z 1504008000  7.62
    ## 62   40 -74 2017-08-30T12:00:00Z 1504094400  6.85
    ## 63   40 -74 2017-08-31T12:00:00Z 1504180800  7.35
    ## 64   40 -74 2017-09-01T12:00:00Z 1504267200  7.00
    ## 65   40 -74 2017-09-02T12:00:00Z 1504353600  7.20
    ## 66   40 -74 2017-09-03T12:00:00Z 1504440000  6.82
    ## 67   40 -74 2017-09-04T12:00:00Z 1504526400  6.73
    ## 68   40 -74 2017-09-05T12:00:00Z 1504612800  7.14
    ## 69   40 -74 2017-09-06T12:00:00Z 1504699200  6.86
    ## 70   40 -74 2017-09-07T12:00:00Z 1504785600  6.53
    ## 71   40 -74 2017-09-08T12:00:00Z 1504872000  6.78
    ## 72   40 -74 2017-09-09T12:00:00Z 1504958400  6.05
    ## 73   40 -74 2017-09-10T12:00:00Z 1505044800  5.94
    ## 74   40 -74 2017-09-11T12:00:00Z 1505131200  6.79
    ## 75   40 -74 2017-09-12T12:00:00Z 1505217600  6.72
    ## 76   40 -74 2017-09-13T12:00:00Z 1505304000  7.18
    ## 77   40 -74 2017-09-14T12:00:00Z 1505390400  6.53
    ## 78   40 -74 2017-09-15T12:00:00Z 1505476800  6.58
    ## 79   40 -74 2017-09-16T12:00:00Z 1505563200  6.14
    ## 80   40 -74 2017-09-17T12:00:00Z 1505649600  6.53
    ## 81   40 -74 2017-09-18T12:00:00Z 1505736000  5.94
    ## 82   40 -74 2017-09-19T12:00:00Z 1505822400  5.99
    ## 83   40 -74 2017-09-28T12:00:00Z 1506600000  5.84
    ## 84   40 -74 2017-09-29T12:00:00Z 1506686400  5.25
    ## 85   40 -74 2017-09-30T12:00:00Z 1506772800  4.53
    ## 86   40 -74 2017-10-01T12:00:00Z 1506859200  4.89
    ## 87   40 -74 2017-10-02T12:00:00Z 1506945600  4.77
    ## 88   40 -74 2017-10-03T12:00:00Z 1507032000  4.65
    ## 89   40 -74 2017-10-04T12:00:00Z 1507118400  4.82
    ## 90   40 -74 2017-10-05T12:00:00Z 1507204800  4.59
    ## 91   40 -74 2017-10-06T12:00:00Z 1507291200  4.60
    ## 92   40 -74 2017-10-07T12:00:00Z 1507377600  4.69
    ## 93   40 -74 2017-10-08T12:00:00Z 1507464000  5.03
    ## 94   40 -74 2017-10-09T12:00:00Z 1507550400  4.97
    ## 95   40 -74 2017-10-10T12:00:00Z 1507636800  4.89
    ## 96   40 -74 2017-10-11T12:00:00Z 1507723200  4.67
    ## 97   40 -74 2017-10-12T12:00:00Z 1507809600  4.33
    ## 98   40 -74 2017-10-13T12:00:00Z 1507896000  4.33
    ## 99   40 -74 2017-10-14T12:00:00Z 1507982400  4.22
    ## 100  40 -74 2017-10-15T12:00:00Z 1508068800  4.23
    ## 101  40 -74 2017-10-16T12:00:00Z 1508155200  3.84
    ## 102  40 -74 2017-10-17T12:00:00Z 1508241600  3.45
    ## 103  40 -74 2017-10-18T12:00:00Z 1508328000  3.50
    ## 104  40 -74 2017-10-19T12:00:00Z 1508414400  3.58
    ## 105  40 -74 2017-10-20T12:00:00Z 1508500800  3.47
    ## 106  40 -74 2017-10-21T12:00:00Z 1508587200  3.32
    ## 107  40 -74 2017-10-22T12:00:00Z 1508673600  3.32

``` r
saveRDS(rds, "api_client_output")
```
